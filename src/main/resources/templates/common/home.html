<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" th:href="@{/css/home.css}"/>
</head>
<body>
<!-- header -->
<div th:replace="header"></div>

<!-- category -->
<div class="container category" style="margin-top: 100px; margin-bottom: -80px;">
    <div class="row">
        <div class="col-sm">
            <a href="home?category=-1">
                <div class="img">
                    <img src="/images/Pack.jpg" class="card-img-top" alt="...">
                </div>
                <p class="txt">All Item</p>
            </a>
        </div>
        <div th:each="category : ${listCategory}" class="col-sm">
            <a th:href="@{'home?category=' + ${category.id}}">
                <div class="img">
                    <img th:src="${category.image}" class="card-img-top" alt="...">
                </div>
                <p class="txt" th:text="${category.name}"></p>
            </a>
        </div>
    </div>
</div>

<!-- !PAGE CONTENT! -->
<div class="w3-main w3-content w3-padding" style="max-width:1200px;margin-top:100px">
    <!-- First Photo Grid-->
    <div class="w3-row-padding w3-padding-16 w3-center row-product" id="food">
        <div th:each="item, loop : ${data}" th:if="${loop.index < 4}" class="w3-quarter session-product">
            <img class="img" th:src="${item.image}" alt="Sandwich" style="width:100%">
            <div>
                <a th:href="@{'/productBuyerDetail?id=' + ${item.id} +'&categoryId=' +${item.category}}">
                    <h3 th:text="${item.name}"></h3>
                    <p th:if="${item.description == ''}" style="margin-top: 0px;">No description</p>
                    <p th:unless="${item.description == ''}" style="margin-top: 0px;" th:text="${item.description}"></p>
                </a>
            </div>
            <div class="price-addtocart">
                <p class="text" th:text="${item.price + '000 ₫'}"></p>
                <form action="addtocart" method="post">
                    <input type="hidden" name="productID" th:value="${item.id}"/>
                    <input type="submit" name="add" value="Add to cart" class="btn btn-addtocart"/>
                </form>
            </div>
        </div>
    </div>

    <!-- Second Photo Grid-->
    <div class="w3-row-padding w3-padding-16 w3-center row-product" id="food">
        <div th:each="item, loop : ${data}" th:if="${loop.index >= 4 and loop.index < 8}"
             class="w3-quarter session-product">
            <img class="img" th:src="${item.image}" alt="Sandwich" style="width:100%">
            <div>
                <a th:href="@{'/productBuyerDetail?id=' + ${item.id} +'&categoryId=' +${item.category}}">
                    <h3 th:text="${item.name}"></h3>
                    <p th:if="${item.description == ''}" style="margin-top: 0px;">No description</p>
                    <p th:unless="${item.description == ''}" style="margin-top: 0px;" th:text="${item.description}"></p>
                </a>
            </div>
            <div class="price-addtocart">
                <p class="text" th:text="${item.price + '000 ₫'}"></p>
                <form action="addtocart" method="post">
                    <input type="hidden" name="productID" th:value="${item.id}"/>
                    <input type="submit" name="add" value="Add to cart" class="btn btn-addtocart"/>
                </form>
            </div>
        </div>
    </div>

    <!-- Third Photo Grid-->
    <div class="w3-row-padding w3-padding-16 w3-center row-product" id="food">
        <div th:each="item, loop : ${data}" th:if="${loop.index >= 8 and loop.index < 12}"
             class="w3-quarter session-product">
            <img class="img" th:src="${item.image}" alt="Sandwich" style="width:100%">
            <div>
                <a th:href="@{'/productBuyerDetail?id=' + ${item.id} +'&categoryId=' +${item.category}}">
                    <h3 th:text="${item.name}"></h3>
                    <p th:if="${item.description == ''}" style="margin-top: 0px;">No description</p>
                    <p th:unless="${item.description == ''}" style="margin-top: 0px;" th:text="${item.description}"></p>
                </a>
            </div>
            <div class="price-addtocart">
                <p class="text" th:text="${item.price + '000 ₫'}"></p>
                <form action="addtocart" method="post">
                    <input type="hidden" name="productID" th:value="${item.id}"/>
                    <input type="submit" name="add" value="Add to cart" class="btn btn-addtocart"/>
                </form>
            </div>
        </div>
    </div>

    <!-- Fourth Photo Grid-->
    <div class="w3-row-padding w3-padding-16 w3-center row-product" id="food">
        <div th:each="item, loop : ${data}" th:if="${loop.index >= 12 and loop.index < 16}"
             class="w3-quarter session-product">
            <img class="img" th:src="${item.image}" alt="Sandwich" style="width:100%">
            <div>
                <a th:href="@{'/productBuyerDetail?id=' + ${item.id} +'&categoryId=' +${item.category}}">
                    <h3 th:text="${item.name}"></h3>
                    <p th:if="${item.description == ''}" style="margin-top: 0px;">No description</p>
                    <p th:unless="${item.description == ''}" style="margin-top: 0px;" th:text="${item.description}"></p>
                </a>
            </div>
            <div class="price-addtocart">
                <p class="text" th:text="${item.price + '000 ₫'}"></p>
                <form action="addtocart" method="post">
                    <input type="hidden" name="productID" th:value="${item.id}"/>
                    <input type="submit" name="add" value="Add to cart" class="btn btn-addtocart"/>
                </form>
            </div>
        </div>
    </div>

    <!-- Pagination -->
    <div class="w3-center w3-padding-32">
        <div class="w3-bar">
            <a th:href="@{'home?page=0'}" class="w3-bar-item w3-button w3-hover-black">«</a>
            <th:block th:each="pageNumber: ${#numbers.sequence(startPage, endPage)}">
                <a th:href="@{'home?page=' + ${pageNumber}}" th:classappend="${pageNumber == thisPage} ? 'w3-bar-item w3-black w3-button' : 'w3-bar-item w3-button w3-hover-black'"
                   th:text="${pageNumber + 1}"></a>
            </th:block>
            <a th:href="@{'home?page=' + ${maxPage - 1}}" class="w3-bar-item w3-button w3-hover-black">»</a>
        </div>
    </div>

    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
         aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content" style="width: 540px; margin-left: 180px;">
                <div class="modal-header">
                    <div>
                        <button class="btn btn-secondary" id="modal_login"
                                style="background-color: #ff5b6a; border: #ff5b6a; width: 100px; height: auto;">Log
                            in
                        </button>
                        <button class="btn btn-secondary" id="modal_signup"
                                style="background-color: #ff5b6a; border: #ff5b6a; width: 100px; height: auto;">Sign
                            up
                        </button>
                    </div>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="padding: 0px;">
                    <div id="divlogin" style=" margin-left: 0px; padding: 0px;  width: 538px;" th:replace="login"></div>
                    <div id="divsignup" style=" margin-left: 0px; padding: 0px;  width: 538px;" hidden
                         th:replace="register"></div>
                </div>
            </div>
        </div>
    </div>

    <hr id="about">

    <!-- slide -->
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://dscnnwjxnwl3f.cloudfront.net/media/banner/b/a/banner_web-01_2.jpg"
                     class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="	https://dscnnwjxnwl3f.cloudfront.net/media/banner/b/a/banner-dli-01_2.jpg"
                     class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="https://dscnnwjxnwl3f.cloudfront.net/media/banner/b/a/banner_web_vxmm-01_vx.jpg"
                     class="d-block w-100" alt="...">
            </div>
        </div>
        <button style="padding: 0; opacity: 0;" class="carousel-control-prev" type="button"
                data-target="#carouselExampleIndicators" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </button>
        <button style="padding: 0; opacity: 0;" class="carousel-control-next" type="button"
                data-target="#carouselExampleIndicators" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </button>
    </div>

    <!-- Footer -->
    <footer class="footer " style="display: grid; padding: 0; margin-top: 0; background-color: #FFEAE3;">
        <div class="container" style="padding: 35px; display: block; max-width: fit-content;">
            <div class="w3-third" style="width: inherit;">
                <h3 style="text-align: center;">ĐĂNG KÝ NHẬN THÔNG TIN KHUYẾN MÃI</h3>
                <p style="text-align: center;">Đặc biệt hơn, NMD-Shop giao hàng MIỄN PHÍ khi bạn đặt hàng
                    qua Website NMD-Shop hoặc gọi đến số 1900.1111.</p>
            </div>
        </div>
        <div class="copyright" style="background-color: #FF9EA2; padding:0px; text-align: center; ">
            <p style="margin-top: 15px; color: white;">© 2023 NMD-Shop All Rights Reserved Site by LDCC</p>
        </div>
    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"
            integrity="sha512-fD9DI5bZwQxOi7MhYWnnNPlvXdp/2Pj3XSTRrFs5FQa4mizyGLnJcN6tuvUS6LbmgN1ut+XGSABKvjN0H6Aoow=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
            crossorigin="anonymous"></script>
    <script>
        // Script to open and close sidebar
        function w3_open() {
            document.getElementById("mySidebar").style.display = "block";
        }

        function w3_close() {
            document.getElementById("mySidebar").style.display = "none";
        }

        function testImageUrl(url) {
            return new Promise(function (resolve, reject) {
                var image = new Image();
                image.addEventListener('load', resolve);
                image.addEventListener('error', reject);
                image.src = url;
            });
        }

        let img = document.getElementsByClassName("img");
        for (let i = 0; i < img.length; i++) {
            testImageUrl(img[i].src).then(function imageLoaded(e) {
                return img[i].src;
            })
                .catch(function imageFailed(e) {
                    return img[i].src = "https://dscnnwjxnwl3f.cloudfront.net/media/catalog/product/cache/2e1628f5f7131a9eb328ec1fb2c22fd3/e/x/extra--534x374px_chicken-soup.png";
                });
        }

        // signup
        var signup = document.getElementById("modal_signup");
        signup.addEventListener("click", function () {
            document.getElementById("divlogin").hidden = true;
            document.getElementById("divsignup").hidden = false;
        });

        // login
        var login = document.getElementById("modal_login");
        login.addEventListener("click", function () {
            document.getElementById("divlogin").hidden = false;
            document.getElementById("divsignup").hidden = true;
        });

        var btnmodal = document.getElementById("btnlogin");
        // click if login fail
        var loginmessage = "${loginmessage}";
        if (loginmessage != null && loginmessage != "") {
            btnmodal.click();
            login.click();
        }

        // click if signup fail
        var signupmessage = "${signupmessage}";
        if (signupmessage != null && signupmessage != "") {
            btnmodal.click();
            signup.click();
        }
    </script>
</body>
</html>